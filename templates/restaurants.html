<html>
    
<head>

    <title>Restaurant Viewer</title>
    
    <link rel="stylesheet" href="static/css/bootstrap.min.css">
    <link rel="stylesheet" href="{{url_for('static',filename='css/style.css')}}">
    <link rel="icon" href="static/images/onepiece.ico"/> 
    
</head>

<body>
    
    <header>
        
        <div class="navbar navbar-dark bg-dark box-shadow fixed-top">
            
            <div class="container">
            
            <h2>Restaurant Viewer</h2>
        
            </div>
            
        </div>

    </header>
    
    
    <div class="container rest-body">
    
        <p>

            <a href="{{url_for('newRestaurant')}}">Create New Restaurant</a>

        </p>

        {%if restaurants|length > 0%}
        
            <div class="row">
        
            {% for i in restaurants %}
            <div class="col-md-4">
                <div class="card mb-4 box-shadow">
                    
                    <img class="card-img-top" src="static/images/uploads/{{i.image_filename}}">
                    
                    <div class="card-body">
                        
                        <a href="{{url_for('showMenu', restaurant_id=i.id)}}"><h5 class="card-title">{{i.name}}</h5></a>
                        <p class="class-text">{{i.description}}</p>
                        
                        <div class="btn-group">
                            
                            <a href="{{url_for('editRestaurant', restaurant_id=i.id)}}" class="btn btn-sm btn-outline-secondary">Edit</a> <br>
                            <a href="#" data-toggle="modal" data-target="#delete-modal" class="btn btn-sm btn-outline-secondary" data-name="{{i.name}}" data-id="{{i.id}}">Delete</a>
                        
                        </div>
                    
                    </div>
                
                </div>
                
                </div>
                
            {% endfor %}
  
            </div>
        
        {%else%}
            <p>There is no restaurant to show.</p>
        {% endif %}
        
    </div>
    
    <!-- Pop-up modal to delete restaurants -->
    <div class="modal fade" id="delete-modal" role="dialog" tabindex="-1">
        
        <div class="modal-dialog" role="document">
            
            <div class="modal-content">
                
                <div class="modal-header">
                
                    <h5 class="modal-title" id="delete-modal-label">Delete Restaurant</h5>
                
                </div>
                
                <div class="modal-body">
                
                    <div id="confirmation-message"></div>
                    
                </div>
                
                <div class="modal-footer">
                
                    <form>
                        
                        <a class="btn btn-secondary" data-dismiss="modal" id="cancel-modal">Cancel</a>
                        <a class="btn btn-primary" id="confirm-delete-modal" data-id="#">Confirm</a>
                        
                    </form>
                
                </div>
            
            </div>
        
        </div>
    
    </div>
    
    <script src="{{url_for('static',filename='js/jquery.min.js')}}"></script>
    <script src="{{url_for('static',filename='js/popper.min.js')}}"></script>
    <script src="{{url_for('static',filename='js/bootstrap.min.js')}}"></script>
    
    <script type="text/javascript">
    
        $("#delete-modal").on('show.bs.modal', function(e){
            
            var button = $(e.relatedTarget);
            var id = button.data('id');
            
            $("#confirmation-message").html("Are you sure you want to delete " + button.data('name') + "?");
            $("#confirm-delete-modal").attr("data-id", id);
            
        });
        
        
        $("#confirm-delete-modal").click(function() {
        
            $.ajax({
                type: "POST",
                url: "/restaurant/" + $("#confirm-delete-modal").attr("data-id") + "/delete",
                data: "dummydata=dummydata",
                success: function(response) {
                   
                    console.log(response); window.location.assign("http://localhost:5000/restaurants");

                },
                error: function(error) {
                    
                    console.log(error);
                    
                }

            })
        
    })
        
    </script>
    
</body>

</html>